var e=Object.defineProperty,a=Object.prototype.hasOwnProperty,t=Object.getOwnPropertySymbols,l=Object.prototype.propertyIsEnumerable,n=(a,t,l)=>t in a?e(a,t,{enumerable:!0,configurable:!0,writable:!0,value:l}):a[t]=l,i=(e,i)=>{for(var r in i||(i={}))a.call(i,r)&&n(e,r,i[r]);if(t)for(var r of t(i))l.call(i,r)&&n(e,r,i[r]);return e};import{d as r,r as d,w as s,D as o,v as c,f as u,h as p,j as g,o as f,a as m,b as v,i as y,F as x,e as h,t as b,l as k}from"./index.8a677f61.js";import"./vendor.be7200f3.js";var w=r({name:"AdvManager",setup(){const e=d(!1),a=function({loading:e}){return{editFlag:d(!1)}}({loading:e});return i(i({loading:e},a),function({loading:e,editFlag:a}){const t=d([]);s(a,(e=>{e||l()}));const l=()=>(e.value=!0,o.get("/api/adv").then((({data:e})=>{e.success?t.value=e.data.sort(((e,a)=>e.index-a.index)).map((e=>(e.editIndex=e.index,e))):c.error(e.msg)})).catch((e=>{c.error(e.toString())})).finally((()=>{e.value=!1})));return l(),{list:t,loadList:l,handleSave:()=>{const a=t.value.filter((e=>e.index!==e.editIndex));return 0===a.length?c.warning("您未修改任何数据!"):(e.value=!0,o.put("/api/adv",{list:a.map((e=>({rawIndex:e.index,newIndex:e.editIndex})))}).then((({data:e})=>{e.success?c.success("修改成功"):c.error(e.msg)})).catch((e=>{c.error(e.toString())})).finally((()=>{e.value=!1,l()})))},handleRemove:a=>(e.value=!0,o.delete("/api/adv",{params:{index:a.index}}).then((({data:e})=>{e.success?c.success("删除成功"):c.error(e.msg)})).catch((e=>{c.error(e.toString())})).finally((()=>{e.value=!1,l()})))}}({loading:e,editFlag:a.editFlag}))}});const F={style:{padding:"30px"},class:"flc"},j={class:"fl",style:{"justify-content":"flex-end"}},I=k("编辑"),C=k("保存"),O=k("取消"),S={class:"advmanager-item fl fl-a-c"},_={style:{margin:"0 20px",width:"200px"}},V=v("div",{class:"fl-1"},null,-1),P={style:{margin:"0 20px"}},R=k("序号 "),U=k("选择展示图片"),A=k("删除"),D={key:1,style:{margin:"0 20px"}};w.render=function(e,a,t,l,n,i){const r=u("el-button"),d=u("el-image"),s=u("el-input-number"),o=p("loading");return g((f(),m("div",F,[v("div",j,[e.editFlag?(f(),m(x,{key:1},[v(r,{type:"primary",onClick:e.handleSave},{default:y((()=>[C])),_:1},8,["onClick"]),v(r,{plain:"",onClick:a[2]||(a[2]=()=>e.editFlag=!1)},{default:y((()=>[O])),_:1})],64)):(f(),m(r,{key:0,type:"primary",onClick:a[1]||(a[1]=()=>e.editFlag=!0)},{default:y((()=>[I])),_:1}))]),(f(!0),m(x,null,h(e.list,(a=>(f(),m("div",S,[v(d,{style:{width:"100px",height:"100px",cursor:"pointer"},src:a.pic,fit:"cover"},null,8,["src"]),v("span",_,b(a.goodsName),1),V,e.editFlag?(f(),m(x,{key:0},[v("span",P,[R,v(s,{modelValue:a.editIndex,"onUpdate:modelValue":e=>a.editIndex=e,"controls-position":"right"},null,8,["modelValue","onUpdate:modelValue"])]),v(r,{plain:"",style:{height:"14px"}},{default:y((()=>[U])),_:1}),v(r,{type:"danger",style:{height:"14px"},onClick:t=>e.handleRemove(a)},{default:y((()=>[A])),_:2},1032,["onClick"])],64)):(f(),m("span",D,"序号 "+b(a.index),1))])))),256))],512)),[[o,e.loading]])};export default w;
