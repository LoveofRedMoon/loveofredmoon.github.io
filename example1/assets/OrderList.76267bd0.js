var e=Object.defineProperty,l=Object.prototype.hasOwnProperty,a=Object.getOwnPropertySymbols,t=Object.prototype.propertyIsEnumerable,r=(l,a,t)=>a in l?e(l,a,{enumerable:!0,configurable:!0,writable:!0,value:t}):l[a]=t,o=(e,o)=>{for(var n in o||(o={}))l.call(o,n)&&r(e,n,o[n]);if(a)for(var n of a(o))t.call(o,n)&&r(e,n,o[n]);return e};import{d as n,m as d,r as i,D as s,v as c,w as p,f as u,h as f,j as g,o as m,a as h,b as v,t as y,i as I,k as D,F as k,e as b,l as x,g as w}from"./index.8a677f61.js";import{g as _}from"./refUtil.896e56f6.js";import"./vendor.be7200f3.js";function S(e,l=2){const a=e.toString();return a.length>=l?a:"0".repeat(l-a.length)+a}function j(e){const l=+e;return new Date(l-(l+288e5)%864e5)}function O(e,l,a="day"){const t=+e;switch(a){case"day":return new Date(t+864e5*l)}}function F(e){return`${S(e.getFullYear(),4)}/${S(e.getMonth()+1)}/${S(e.getDate())} ${S(e.getHours())}:${S(e.getMinutes())}:${S(e.getSeconds())}`}function V(e){return"string"==typeof e?0===parseFloat(e):0===e}var C=n({name:"OrderDetail",props:{orderId:{type:String,required:!0}},emits:["close"],setup(e,l){const a=d(e,"orderId"),t=i(!1);return o(o(o({orderId:a,loading:t},function({orderId:e,loading:l}){const a=_(),t=i([]),r=()=>(l.value=!0,s.get("/api/packInfo/"+e.value).then((({data:e})=>{e.success?t.value=e.data:c.error(e.msg)})).catch((e=>{c.error(e.toString())})).finally((()=>{l.value=!1}))),o=()=>(l.value=!0,s.get("/api/orders/"+e.value).then((({data:e})=>{e.success?a.value=e.data:c.error(e.msg)})).catch((e=>{c.error("加载订单详情失败! "+e.toString())})).finally((()=>{l.value=!1,r()})));return p(e,o,{immediate:!0}),{orderDetail:a,packInfo:t,loadOrderDetail:o,loadPackInfo:r}}({orderId:a,loading:t})),function({orderId:e,loading:l,emit:a}){return{handleChargeBack:t=>(l.value=!0,s.put("/api/chargeback/"+e.value,{agree:t}).then((({data:e})=>{e.success?(c.success(t?"同意退货成功!":"拒绝退货成功!"),a("close")):c.error((t?"同意退货失败!":"拒绝退货失败!")+e.msg)})).catch((e=>{c.error((t?"同意退货失败!":"拒绝退货失败!")+e.toString())})).finally((()=>{l.value=!1})))}}({orderId:a,loading:t,emit:l.emit})),{isZero:V})}});const N={key:0,class:"flc"},P={class:"fl fl-w"},z=v("span",{class:"orderdetail-title"},"订单编号",-1),U={class:"fl-1",style:{"min-width":"200px"}},$=v("span",{class:"orderdetail-title"},"创建时间",-1),B={class:"fl-1",style:{"min-width":"200px"}},M=v("span",{class:"orderdetail-title"},"订单状态",-1),R={class:"fl-1"},Z=v("span",{class:"orderdetail-title"},"总价",-1),q={class:"fl-1"},E=v("span",{class:"orderdetail-title"},"运费",-1),H={class:"fl-1"},L={class:"fl fl-j-sb",style:{"margin-top":"18px"}},Y={key:0,class:"flc",style:{width:"30%"}},A=x("收货人信息"),G=v("span",{class:"orderdetail-title"},"姓名",-1),J={style:{"margin-top":"8px"}},K=v("span",{class:"orderdetail-title"},"电话",-1),Q={style:{"margin-top":"8px"}},T=v("span",{class:"orderdetail-title"},"收货地址",-1),W={class:"fl",style:{"margin-top":"8px"}},X=v("span",{class:"orderdetail-title"},"备注",-1),ee={style:{width:"30%"}},le=x("京东订单信息"),ae=v("span",{class:"orderdetail-title"},"京东单号",-1),te={style:{"margin-top":"8px"}},re=v("span",{class:"orderdetail-title"},"是否支持无理由退换货",-1),oe={key:1,style:{width:"30%"}},ne=x("京东退换货订单信息"),de=v("span",{class:"orderdetail-title"},"京东退换货单号",-1),ie={style:{"margin-top":"8px"}},se=v("span",{class:"orderdetail-title"},"是否支持无理由退换货",-1),ce=x("商品信息"),pe={class:"fl fl-w"},ue={class:"orderdetail-goods fl"},fe={class:"flc",style:{margin:"0 24px","line-height":"28px"}},ge=x("物流信息 "),me=x("退货申请"),he={class:"fl"},ve={style:{width:"200px","margin-right":"20px"}},ye={class:"fl fl-1 fl-w"},Ie={class:"fl",style:{"align-items":"flex-end"}},De=x("同意退货"),ke=x("拒绝退货");C.render=function(e,l,a,t,r,o){var n;const d=u("el-divider"),i=u("el-image"),s=u("el-timeline-item"),c=u("el-timeline"),p=u("el-button"),w=f("loading");return g((m(),h("div",null,[e.orderDetail?(m(),h("div",N,[v("div",P,[z,v("span",U,y(e.orderDetail.orderId),1),$,v("span",B,y(e.orderDetail.createDate),1),M,v("span",R,y(e.orderDetail.orderStateStr),1),Z,v("span",q,y(e.orderDetail.totalPrice)+"元",1),E,v("span",H,y(e.isZero(e.orderDetail.carriagePrice)?"免运费":e.orderDetail.carriagePrice+"元"),1)]),v("div",L,[e.orderDetail.receiveInfo?(m(),h("div",Y,[v(d,{"content-position":"left"},{default:I((()=>[A])),_:1}),v("div",null,[G,v("span",null,y(e.orderDetail.receiveInfo.custName),1)]),v("div",J,[K,v("span",null,y(e.orderDetail.receiveInfo.phone),1)]),v("div",Q,[T,v("span",null,y(e.orderDetail.receiveInfo.address),1)]),v("div",W,[X,v("span",null,y(e.orderDetail.receiveInfo.remark),1)])])):D("",!0),v("div",ee,[v(d,{"content-position":"left"},{default:I((()=>[le])),_:1}),v("div",null,[ae,v("span",null,y(e.orderDetail.jdInfo.orderId),1)]),v("div",te,[re,v("span",null,y(e.orderDetail.jdInfo.supportNoReason),1)])]),e.orderDetail.jdInfo.chargeBackOrderId?(m(),h("div",oe,[v(d,{"content-position":"left"},{default:I((()=>[ne])),_:1}),v("div",null,[de,v("span",null,y(e.orderDetail.jdInfo.chargeBackOrderId),1)]),v("div",ie,[se,v("span",null,y(e.orderDetail.jdInfo.supportChargeBackNoReason),1)])])):D("",!0)]),v(d,{"content-position":"left",style:{"margin-top":"30px"}},{default:I((()=>[ce])),_:1}),v("div",pe,[(m(!0),h(k,null,b(e.orderDetail.goodsInfo,((l,a)=>(m(),h(k,null,[v("div",ue,[v(i,{style:{width:"150px",height:"150px"},src:l.pic,fit:"cover"},null,8,["src"]),v("div",fe,[v("span",null,y(l.goodsName),1),v("span",null,"单价"+y(l.price)+"元",1),v("span",null,"数量: "+y(l.goodsNum),1),v("span",null,"型号: "+y(l.modelStr),1)])]),a<e.orderDetail.goodsInfo.length-1?(m(),h(d,{key:0,direction:"vertical",style:{height:"initial"}})):D("",!0)],64)))),256))]),v(d,{"content-position":"left"},{default:I((()=>[ge,v("i",{onClick:l[1]||(l[1]=(...l)=>e.loadPackInfo&&e.loadPackInfo(...l)),class:"el-icon-refresh",style:{cursor:"pointer"}})])),_:1}),v(c,{style:{"margin-left":"80px"}},{default:I((()=>[(m(!0),h(k,null,b(e.packInfo,((e,l)=>(m(),h(s,{timestamp:e.time},{default:I((()=>[x(y(e.mark),1)])),_:2},1032,["timestamp"])))),256))])),_:1}),(null==(n=e.orderDetail)?void 0:n.chargebackInfo)?(m(),h(k,{key:0},[v(d,{"content-position":"left"},{default:I((()=>[me])),_:1}),v("div",he,[v("span",ve,y(e.orderDetail.chargebackInfo.remark),1),v("div",ye,[(m(!0),h(k,null,b(e.orderDetail.chargebackInfo.pics,(e=>(m(),h(i,{style:{width:"150px",height:"150px","margin-right":"20px"},src:e,fit:"cover"},null,8,["src"])))),256))]),v("div",Ie,[v(p,{type:"primary",onClick:l[2]||(l[2]=l=>e.handleChargeBack(!0))},{default:I((()=>[De])),_:1}),v(p,{type:"danger",onClick:l[3]||(l[3]=l=>e.handleChargeBack(!1))},{default:I((()=>[ke])),_:1})])])],64)):D("",!0)])):D("",!0)],512)),[[w,e.loading]])};var be=n({name:"OrderList",components:{OrderDetail:C},setup(){const e=i(!1);return o(o({loading:e},function({loading:e}){const l=w({type:"",date:[j(new Date),O(j(new Date),1,"day")],orderId:"",phone:""}),a=i(0),t=i([]),r=i(1),o=i(20),n=()=>{var n,d;e.value=!0,s.get("/api/orders",{params:{type:l.type,startDate:(null==(n=l.date)?void 0:n[0])?F(l.date[0]):void 0,endDate:(null==(d=l.date)?void 0:d[1])?F(l.date[1]):void 0,orderId:l.orderId,phone:l.phone,pageNum:r.value,pageSize:o.value}}).then((({data:e})=>{console.log(e),e.success?(t.value=e.data.list,a.value=e.data.total):c.error(e.msg)})).catch((e=>{c.error(e.toString())})).finally((()=>{e.value=!1}))};return p(r,n),p(o,(()=>{1===r.value?n():r.value=1})),n(),{pageNum:r,pageSize:o,total:a,searchForm:l,handleSearch:n,list:t}}({loading:e})),function(){const e=_();return{detailInfo:e,handleOrderDetail:l=>{e.value=l}}}())}});const xe={style:{padding:"30px"}},we=x("搜索"),_e=x("查看"),Se=x("联系客户");be.render=function(e,l,a,t,r,o){var n;const d=u("el-option"),i=u("el-select"),s=u("el-form-item"),c=u("el-date-picker"),p=u("el-input"),y=u("el-button"),b=u("el-form"),x=u("el-table-column"),w=u("el-table"),_=u("el-pagination"),S=u("order-detail"),j=u("el-dialog"),O=f("loading");return m(),h(k,null,[v("div",xe,[v(b,{inline:!0,model:e.searchForm,class:"fl fl-w fl-j-sb orders-search-form"},{default:I((()=>[v(s,{label:"类型筛选"},{default:I((()=>[v(i,{modelValue:e.searchForm.type,"onUpdate:modelValue":l[1]||(l[1]=l=>e.searchForm.type=l)},{default:I((()=>[v(d,{label:"选项1",value:"1"}),v(d,{label:"选项2",value:"2"})])),_:1},8,["modelValue"])])),_:1}),v(s,{label:"日期筛选"},{default:I((()=>[v(c,{modelValue:e.searchForm.date,"onUpdate:modelValue":l[2]||(l[2]=l=>e.searchForm.date=l),type:"datetimerange",shortcuts:[],"range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期"},null,8,["modelValue"])])),_:1}),v(s,{label:"订单号"},{default:I((()=>[v(p,{modelValue:e.searchForm.orderId,"onUpdate:modelValue":l[3]||(l[3]=l=>e.searchForm.orderId=l),placeholder:"订单号"},null,8,["modelValue"])])),_:1}),v(s,{label:"手机号"},{default:I((()=>[v(p,{modelValue:e.searchForm.phone,"onUpdate:modelValue":l[4]||(l[4]=l=>e.searchForm.phone=l),placeholder:"手机号"},null,8,["modelValue"])])),_:1}),v(s,null,{default:I((()=>[v(y,{type:"primary",onClick:e.handleSearch,loading:e.loading},{default:I((()=>[we])),_:1},8,["onClick","loading"])])),_:1})])),_:1},8,["model"]),g(v(w,{data:e.list,stripe:"",style:{width:"100%"}},{default:I((()=>[v(x,{prop:"orderId",label:"订单编号",width:"180",align:"center"}),v(x,{prop:"goodsName",label:"商品名称",width:"180",align:"center"}),v(x,{prop:"totalPrice",label:"总价",align:"center"}),v(x,{prop:"createDate",label:"创建日期",align:"center",width:"180"}),v(x,{prop:"orderStateStr",label:"发货情况",align:"center"}),v(x,{fixed:"right",label:"操作",width:"180",align:"center"},{default:I((l=>[v(y,{onClick:a=>e.handleOrderDetail(l.row),type:"text"},{default:I((()=>[_e])),_:2},1032,["onClick"]),v(y,{type:"text"},{default:I((()=>[Se])),_:1})])),_:1})])),_:1},8,["data"]),[[O,e.loading]]),v(_,{style:{"margin-top":"20px","text-align":"right"},"current-page":e.pageNum,"onUpdate:current-page":l[5]||(l[5]=l=>e.pageNum=l),"page-size":e.pageSize,"onUpdate:page-size":l[6]||(l[6]=l=>e.pageSize=l),layout:"total, sizes, prev, pager, next, jumper",total:e.total},null,8,["current-page","page-size","total"])]),v(j,{title:`订单[${null==(n=e.detailInfo)?void 0:n.orderId}]详情`,"model-value":!!e.detailInfo,"onUpdate:modelValue":l[8]||(l[8]=l=>!l&&(e.detailInfo=null)),width:"80%"},{default:I((()=>{var a;return[(null==(a=e.detailInfo)?void 0:a.orderId)?(m(),h(S,{key:0,orderId:e.detailInfo.orderId,onClose:l[7]||(l[7]=()=>e.detailInfo=null)},null,8,["orderId"])):D("",!0)]})),_:1},8,["title","model-value"])],64)};export default be;
